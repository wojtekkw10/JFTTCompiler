/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package compiler;
import org.antlr.v4.runtime.*;
import org.antlr.v4.runtime.tree.ParseTreeWalker;
import parser.JFTTLexer;
import parser.JFTTParser;

public class App {

    public static void main(String[] args){
        //Parsing program parameters
        BaseArgParser argumentParser = new ArgParser();
        argumentParser.parse(args);

        //Creating Lexer
        JFTTLexer lexer = new JFTTLexer(argumentParser.getCharStream());

        //Creating the Symbol Table
        JFTTParser parser = new JFTTParser(new CommonTokenStream(lexer));
        ParseTreeWalker walker = new ParseTreeWalker();
        SymbolTableGenerator symbolTableGenerator = new SymbolTableGenerator();
        walker.walk(symbolTableGenerator, parser.program());
        System.out.println(symbolTableGenerator);


        if( parser.getNumberOfSyntaxErrors() == 0 ) {
            System.out.println("> Symbol Table Created Successfully");
        }
        else System.err.println("> Error: Syntax Errors");
    }
}

//TODO: refactor
//TODO: different stages of checking for errors in different classes that have common function check()
//TODO: Put them in an array and run in a sequence